<% truncated = false if local_assigns[:truncated].nil? %>

<%= link_to admin_offer_path(offer), class: 'list-group-item list-item--offer', data: { id: offer.id } do %>
  <span>
    <% if offer.locked? %>
      <div class='locked'>
        <%= image_tag(image_url('lock.svg'), id: 'lock') %>
      </div>
    <% else %>
      <div class='spacer'>
      </div>
    <% end %>
  </span>
  <div class='list-group-item-info'>
    <% if offer.state != Offer::SENT || offer.offer_responses.empty? %>
      <%= offer.state %>
    <% else %>
      <% offer_response = offer.offer_responses.order(created_at: :desc).first %>
      <% if offer_response.intended_state == Offer::ACCEPTED %>
        <div class='green'>
          Response: Accept
        </div>
      <% elsif offer_response.intended_state == Offer::REJECTED %>
        <div class='red'>
          Response: Reject
        </div>
      <% else %>
        <div class='purple-label'>
          Response: Interested
        </div>
      <% end %>
    <% end %>
  </div>
  <div class='list-group-item-info'>
    <%= offer.created_at.strftime('%m/%d/%Y') %>
  </div>
  <div class='list-group-item-info'>
    <%= offer.partner.name %>
  </div>
  <% if truncated %>
    <div class='list-group-item-info'>
      <%= offer.best_price_display || '-' %>
    </div>
  <% else %>
    <div class='list-group-item-info'>
      <%= offer.submission.user&.email %>
    </div>
    <div class='list-group-item-info'>
      <%= offer.price_display %>
    </div>
    <div class='list-group-item-info'>
      <%= offer.high_estimate_display %>
    </div>
    <div class='list-group-item-info'>
      <% if offer.commission_percent %>
        <%= offer.commission_percent_whole %>
      <% else %>
      -
      <% end %>
    </div>
  <% end %>
  <div class='list-group-item-info'>
    <%= offer.offer_type %>
  </div>
  <span class='icon-chevron-right'></span>
<% end %>
